<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF- />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SolusiYa - Find Free Help Near You</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body { margin: 0; font-family: Arial, sans-serif; }
    header {
      background: #014a63;
      color: white;
      padding: 1rem;
      text-align: center;
    }
    form {
      padding: 1rem;
      background: #f2f2f2;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    form select, form button {
      padding: 0.5rem;
      font-size: 1rem;
    }
    #map {
      height: 80vh;
    }
    @media (max-width: 600px) {
      form {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>SolusiYa</h1>
    <p>Find free food, shelter, or health support near you</p>
    <select id="lang-select">
      <option value="en">English</option>
      <option value="es">EspaÃ±ol</option>
      <option value="pt">PortuguÃªs</option>
    </select>
  </header>

  <form id="helpForm">
    <select id="country">
      <option value="all">ðŸŒŽ All Countries</option>
      <option value="usa">ðŸ‡ºðŸ‡¸ USA</option>
      <option value="brazil">ðŸ‡§ðŸ‡· Brazil</option>
    </select>

    <select id="state" style="display:none;">
      <option value="all">All States</option>
      <option value="al">Alabama</option>
      <option value="ak">Alaska</option>
      <option value="az">Arizona</option>
      <option value="ar">Arkansas</option>
      <option value="ca">California</option>
      <option value="co">Colorado</option>
      <option value="ct">Connecticut</option>
      <option value="de">Delaware</option>
      <option value="fl">Florida</option>
      <option value="ga">Georgia</option>
      <option value="hi">Hawaii</option>
      <option value="id">Idaho</option>
      <option value="il">Illinois</option>
      <option value="in">Indiana</option>
      <option value="ia">Iowa</option>
      <option value="ks">Kansas</option>
      <option value="ky">Kentucky</option>
      <option value="la">Louisiana</option>
      <option value="me">Maine</option>
      <option value="md">Maryland</option>
      <option value="ma">Massachusetts</option>
      <option value="mi">Michigan</option>
      <option value="mn">Minnesota</option>
      <option value="ms">Mississippi</option>
      <option value="mo">Missouri</option>
      <option value="mt">Montana</option>
      <option value="ne">Nebraska</option>
      <option value="nv">Nevada</option>
      <option value="nh">New Hampshire</option>
      <option value="nj">New Jersey</option>
      <option value="nm">New Mexico</option>
      <option value="ny">New York</option>
      <option value="nc">North Carolina</option>
      <option value="nd">North Dakota</option>
      <option value="oh">Ohio</option>
      <option value="ok">Oklahoma</option>
      <option value="or">Oregon</option>
      <option value="pa">Pennsylvania</option>
      <option value="ri">Rhode Island</option>
      <option value="sc">South Carolina</option>
      <option value="sd">South Dakota</option>
      <option value="tn">Tennessee</option>
      <option value="tx">Texas</option>
      <option value="ut">Utah</option>
      <option value="vt">Vermont</option>
      <option value="va">Virginia</option>
      <option value="wa">Washington</option>
      <option value="wv">West Virginia</option>
      <option value="wi">Wisconsin</option>
      <option value="wy">Wyoming</option>
    </select>

    <select id="type">
      <option value="all">All Help Types</option>
      <option value="shelter">Shelter</option>
      <option value="food">Food</option>
      <option value="medical">Medical</option>
    </select>

    <button type="submit">Find Help</button>
  </form>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([37.8, -96], 4);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    const helpCenters = [/* PASTE VERIFIED SHELTER LIST HERE (50 entries) */];

    const markers = [];

    function renderMarkers(data) {
      markers.forEach(m => map.removeLayer(m));
      data.forEach(loc => {
        const m = L.marker([loc.lat, loc.lng])
          .addTo(map)
          .bindPopup(`<strong>${loc.name}</strong><br>${loc.address}<br><em>${loc.services.join(', ')}</em>`);
        markers.push(m);
      });
    }

    function filterLocations(country, state, type) {
      return helpCenters.filter(loc => {
        const countryMatch = country === "all" || loc.country === country;
        const stateMatch = country !== "usa" || state === "all" || loc.state === state;
        const typeMatch = type === "all" || loc.services.includes(type);
        return countryMatch && stateMatch && typeMatch;
      });
    }

    document.getElementById('country').addEventListener('change', function () {
      const stateSelect = document.getElementById('state');
      stateSelect.style.display = this.value === 'usa' ? 'inline-block' : 'none';
    });

    document.getElementById('helpForm').addEventListener('submit', e => {
      e.preventDefault();
      const country = document.getElementById('country').value;
      const state = document.getElementById('state').value;
      const type = document.getElementById('type').value;
      const filtered = filterLocations(country, state, type);
      renderMarkers(filtered);
      if (filtered.length) {
        map.setView([filtered[0].lat, filtered[0].lng], 6);
      }
    });

    renderMarkers(helpCenters);
  </script>
</body>
</html>